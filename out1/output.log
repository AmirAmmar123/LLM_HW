21:40:41 - INFO - --- Top 20 Speakers ---
21:40:41 - INFO - 1. ראובן ריבלין: 3201
21:40:41 - INFO - 2. א' בורג: 2337
21:40:41 - INFO - 3. משה גפני: 1700
21:40:41 - INFO - 4. ניסן סלומינסקי: 1413
21:40:41 - INFO - 5. אברהם פורז: 1134
21:40:41 - INFO - 6. מיכאל איתן: 1023
21:40:41 - INFO - 7. עבד-אלמאלכ דהאמשה: 995
21:40:41 - INFO - 8. אבשלום וילן: 945
21:40:41 - INFO - 9. טלב אלסאנע: 942
21:40:41 - INFO - 10. ד' טל: 923
21:40:41 - INFO - 11. עזמי בשארה: 921
21:40:41 - INFO - 12. זבולון אורלב: 920
21:40:41 - INFO - 13. תמר גוז'נסקי: 891
21:40:41 - INFO - 14. נסים זאב: 886
21:40:41 - INFO - 15. יוסף ג'בארין: 827
21:40:41 - INFO - 16. אחמד טיבי: 824
21:40:41 - INFO - 17. מאיר שטרית: 795
21:40:41 - INFO - 18. ש' וייס: 785
21:40:41 - INFO - 19. רוני בר-און: 784
21:40:41 - INFO - 20. שאול יהלום: 777
21:40:41 - INFO - Searching for variations of 'ריבלין' and 'בורג'
21:40:41 - INFO - Found 3 variations for ריבלין: {'ראובן ריבלין', 'רובי ריבלין', "ר' ריבלין"}
21:40:41 - INFO - Found 2 variations for בורג: {'אברהם בורג', "א' בורג"}
21:40:42 - INFO - --- Binary Data Loaded ---
21:40:42 - INFO - Class 1 (Label 0): 3509
21:40:42 - INFO - Class 2 (Label 1): 2487
21:40:42 - INFO - Total: 5996
21:40:42 - INFO - --- Balancing Binary Classes ---
21:40:42 - INFO - Counts before: Class 0=3509, Class 1=2487
21:40:42 - INFO - Counts after: Class 0=2487, Class 1=2487
21:40:42 - INFO - --- Creating Feature Vectors (Binary) ---
21:40:42 - INFO - BOW Vector shape: (4974, 1259)
21:40:42 - INFO - TF-IDF Vector shape: (4974, 1259)
21:40:42 - INFO - Custom Vector shape: (4974, 31)
21:40:42 - INFO - Loading Multi-Class Data...
21:40:43 - INFO - --- Multi-Class Data Loaded ---
21:40:43 - INFO - Class 0: 3509, Class 1: 2487, Class 2: 102137
21:40:43 - INFO - Total: 108133
21:40:43 - INFO - --- Balancing Multi-Class Classes ---
21:40:43 - INFO - Counts before: 0=3509, 1=2487, 2=102137
21:40:43 - INFO - Down-sampling to 2487 per class.
21:40:43 - INFO - Counts after: 0=2487, 1=2487, 2=2487
21:40:43 - INFO - --- Creating Feature Vectors (Multi-Class) ---
21:40:43 - INFO - BOW Vector shape: (7461, 2131)
21:40:43 - INFO - TF-IDF Vector shape: (7461, 2131)
21:40:43 - INFO - Custom Vector shape: (7461, 31)
21:40:43 - INFO - 
==============================
21:40:43 - INFO -  RUNNING BINARY CLASSIFICATION 
21:40:43 - INFO - ==============================
21:40:43 - INFO - 
===== Binary Classification | BOW =====
21:40:44 - INFO - k=1: f1=0.7901
21:40:44 - INFO - k=3: f1=0.8040
21:40:44 - INFO - k=5: f1=0.8105
21:40:45 - INFO - k=7: f1=0.8067
21:40:45 - INFO - k=9: f1=0.8026
21:40:45 - INFO - k=11: f1=0.7959
21:40:45 - INFO - k=15: f1=0.7866
21:40:45 - INFO - k=21: f1=0.7683
21:40:45 - INFO - Best k = 5 (score=0.8105)
21:40:46 - INFO - 
--- KNN ---
21:40:46 - INFO -               precision    recall  f1-score   support

           0      0.781     0.864     0.821      2487
           1      0.848     0.758     0.800      2487

    accuracy                          0.811      4974
   macro avg      0.815     0.811     0.810      4974
weighted avg      0.815     0.811     0.810      4974

21:40:46 - INFO - 
--- Logistic Regression ---
21:40:46 - INFO -               precision    recall  f1-score   support

           0      0.847     0.898     0.872      2487
           1      0.891     0.838     0.864      2487

    accuracy                          0.868      4974
   macro avg      0.869     0.868     0.868      4974
weighted avg      0.869     0.868     0.868      4974

21:40:46 - INFO - 
===== Binary Classification | TF-IDF =====
21:40:46 - INFO - k=1: f1=0.8340
21:40:47 - INFO - k=3: f1=0.8280
21:40:47 - INFO - k=5: f1=0.8091
21:40:47 - INFO - k=7: f1=0.7832
21:40:47 - INFO - k=9: f1=0.7624
21:40:48 - INFO - k=11: f1=0.7444
21:40:48 - INFO - k=15: f1=0.7161
21:40:49 - INFO - k=21: f1=0.7129
21:40:49 - INFO - Best k = 1 (score=0.8340)
21:40:49 - INFO - 
--- KNN ---
21:40:49 - INFO -               precision    recall  f1-score   support

           0      0.805     0.882     0.842      2487
           1      0.869     0.787     0.826      2487

    accuracy                          0.834      4974
   macro avg      0.837     0.834     0.834      4974
weighted avg      0.837     0.834     0.834      4974

21:40:49 - INFO - 
--- Logistic Regression ---
21:40:49 - INFO -               precision    recall  f1-score   support

           0      0.827     0.927     0.874      2487
           1      0.917     0.807     0.858      2487

    accuracy                          0.867      4974
   macro avg      0.872     0.867     0.866      4974
weighted avg      0.872     0.867     0.866      4974

21:40:49 - INFO - 
===== Binary Classification | Custom Features =====
21:40:49 - INFO - k=1: f1=0.7770
21:40:49 - INFO - k=3: f1=0.8045
21:40:49 - INFO - k=5: f1=0.8083
21:40:50 - INFO - k=7: f1=0.8077
21:40:50 - INFO - k=9: f1=0.8117
21:40:50 - INFO - k=11: f1=0.8143
21:40:50 - INFO - k=15: f1=0.8125
21:40:50 - INFO - k=21: f1=0.8156
21:40:50 - INFO - Best k = 21 (score=0.8156)
21:40:50 - INFO - 
--- KNN ---
21:40:50 - INFO -               precision    recall  f1-score   support

           0      0.803     0.836     0.819      2487
           1      0.829     0.795     0.812      2487

    accuracy                          0.816      4974
   macro avg      0.816     0.816     0.816      4974
weighted avg      0.816     0.816     0.816      4974

21:40:50 - INFO - 
--- Logistic Regression ---
21:40:50 - INFO -               precision    recall  f1-score   support

           0      0.835     0.774     0.803      2487
           1      0.789     0.847     0.817      2487

    accuracy                          0.810      4974
   macro avg      0.812     0.810     0.810      4974
weighted avg      0.812     0.810     0.810      4974

21:40:51 - INFO - 
===== Binary Classification | BOW + Custom =====
21:40:51 - INFO - k=1: f1=0.8273
21:40:52 - INFO - k=3: f1=0.8362
21:40:53 - INFO - k=5: f1=0.8358
21:40:54 - INFO - k=7: f1=0.8355
21:40:55 - INFO - k=9: f1=0.8349
21:40:55 - INFO - k=11: f1=0.8348
21:40:56 - INFO - k=15: f1=0.8388
21:40:57 - INFO - k=21: f1=0.8342
21:40:57 - INFO - Best k = 15 (score=0.8388)
21:40:58 - INFO - 
--- KNN ---
21:40:58 - INFO -               precision    recall  f1-score   support

           0      0.810     0.887     0.847      2487
           1      0.875     0.791     0.831      2487

    accuracy                          0.839      4974
   macro avg      0.842     0.839     0.839      4974
weighted avg      0.842     0.839     0.839      4974

21:40:58 - INFO - 
--- Logistic Regression ---
21:40:58 - INFO -               precision    recall  f1-score   support

           0      0.870     0.906     0.888      2487
           1      0.902     0.864     0.883      2487

    accuracy                          0.885      4974
   macro avg      0.886     0.885     0.885      4974
weighted avg      0.886     0.885     0.885      4974

21:40:58 - INFO - 
===== Binary Classification | TF-IDF + Custom =====
21:40:59 - INFO - k=1: f1=0.8126
21:41:00 - INFO - k=3: f1=0.8233
21:41:01 - INFO - k=5: f1=0.8283
21:41:01 - INFO - k=7: f1=0.8276
21:41:02 - INFO - k=9: f1=0.8253
21:41:03 - INFO - k=11: f1=0.8253
21:41:04 - INFO - k=15: f1=0.8211
21:41:04 - INFO - k=21: f1=0.8169
21:41:04 - INFO - Best k = 5 (score=0.8283)
21:41:05 - INFO - 
--- KNN ---
21:41:05 - INFO -               precision    recall  f1-score   support

           0      0.807     0.863     0.834      2487
           1      0.853     0.794     0.822      2487

    accuracy                          0.829      4974
   macro avg      0.830     0.829     0.828      4974
weighted avg      0.830     0.829     0.828      4974

21:41:06 - INFO - 
--- Logistic Regression ---
21:41:06 - INFO -               precision    recall  f1-score   support

           0      0.858     0.883     0.870      2487
           1      0.880     0.854     0.867      2487

    accuracy                          0.869      4974
   macro avg      0.869     0.869     0.868      4974
weighted avg      0.869     0.869     0.868      4974

21:41:06 - INFO - 
==============================
21:41:06 - INFO -  RUNNING MULTI-CLASS CLASSIFICATION 
21:41:06 - INFO - ==============================
21:41:06 - INFO - 
===== Multi-Class Classification | BOW =====
21:41:06 - INFO - k=1: f1=0.5879
21:41:07 - INFO - k=3: f1=0.6087
21:41:07 - INFO - k=5: f1=0.5992
21:41:08 - INFO - k=7: f1=0.6115
21:41:08 - INFO - k=9: f1=0.6196
21:41:09 - INFO - k=11: f1=0.6176
21:41:09 - INFO - k=15: f1=0.6151
21:41:10 - INFO - k=21: f1=0.6169
21:41:10 - INFO - Best k = 9 (score=0.6196)
21:41:10 - INFO - 
--- KNN ---
21:41:10 - INFO -               precision    recall  f1-score   support

           0      0.548     0.507     0.526      2487
           1      0.788     0.706     0.745      2487
           2      0.543     0.641     0.588      2487

    accuracy                          0.618      7461
   macro avg      0.626     0.618     0.620      7461
weighted avg      0.626     0.618     0.620      7461

21:41:11 - INFO - 
--- Logistic Regression ---
21:41:11 - INFO -               precision    recall  f1-score   support

           0      0.638     0.632     0.635      2487
           1      0.857     0.813     0.835      2487
           2      0.637     0.676     0.656      2487

    accuracy                          0.707      7461
   macro avg      0.711     0.707     0.709      7461
weighted avg      0.711     0.707     0.709      7461

21:41:11 - INFO - 
===== Multi-Class Classification | TF-IDF =====
21:41:12 - INFO - k=1: f1=0.6157
21:41:12 - INFO - k=3: f1=0.6158
21:41:13 - INFO - k=5: f1=0.6021
21:41:13 - INFO - k=7: f1=0.5982
21:41:14 - INFO - k=9: f1=0.5837
21:41:14 - INFO - k=11: f1=0.5705
21:41:15 - INFO - k=15: f1=0.5844
21:41:15 - INFO - k=21: f1=0.6516
21:41:15 - INFO - Best k = 21 (score=0.6516)
21:41:16 - INFO - 
--- KNN ---
21:41:16 - INFO -               precision    recall  f1-score   support

           0      0.640     0.475     0.545      2487
           1      0.925     0.660     0.770      2487
           2      0.527     0.813     0.639      2487

    accuracy                          0.649      7461
   macro avg      0.697     0.649     0.652      7461
weighted avg      0.697     0.649     0.652      7461

21:41:17 - INFO - 
--- Logistic Regression ---
21:41:17 - INFO -               precision    recall  f1-score   support

           0      0.651     0.628     0.639      2487
           1      0.876     0.801     0.837      2487
           2      0.634     0.711     0.670      2487

    accuracy                          0.713      7461
   macro avg      0.720     0.713     0.715      7461
weighted avg      0.720     0.713     0.715      7461

21:41:17 - INFO - 
===== Multi-Class Classification | Custom Features =====
21:41:17 - INFO - k=1: f1=0.6126
21:41:17 - INFO - k=3: f1=0.6419
21:41:17 - INFO - k=5: f1=0.6461
21:41:17 - INFO - k=7: f1=0.6598
21:41:17 - INFO - k=9: f1=0.6696
21:41:18 - INFO - k=11: f1=0.6691
21:41:18 - INFO - k=15: f1=0.6789
21:41:18 - INFO - k=21: f1=0.6762
21:41:18 - INFO - Best k = 15 (score=0.6789)
21:41:18 - INFO - 
--- KNN ---
21:41:18 - INFO -               precision    recall  f1-score   support

           0      0.696     0.708     0.702      2487
           1      0.726     0.673     0.699      2487
           2      0.619     0.654     0.636      2487

    accuracy                          0.678      7461
   macro avg      0.681     0.678     0.679      7461
weighted avg      0.681     0.678     0.679      7461

21:41:20 - INFO - 
--- Logistic Regression ---
21:41:20 - INFO -               precision    recall  f1-score   support

           0      0.734     0.699     0.716      2487
           1      0.677     0.680     0.678      2487
           2      0.621     0.647     0.633      2487

    accuracy                          0.675      7461
   macro avg      0.677     0.675     0.676      7461
weighted avg      0.677     0.675     0.676      7461

21:41:20 - INFO - 
===== Multi-Class Classification | BOW + Custom =====
21:41:22 - INFO - k=1: f1=0.6759
21:41:24 - INFO - k=3: f1=0.6905
21:41:26 - INFO - k=5: f1=0.6994
21:41:28 - INFO - k=7: f1=0.7148
21:41:32 - INFO - k=9: f1=0.7184
21:41:34 - INFO - k=11: f1=0.7169
21:41:36 - INFO - k=15: f1=0.7202
21:41:38 - INFO - k=21: f1=0.7156
21:41:38 - INFO - Best k = 15 (score=0.7202)
21:41:40 - INFO - 
--- KNN ---
21:41:40 - INFO -               precision    recall  f1-score   support

           0      0.724     0.690     0.707      2487
           1      0.835     0.698     0.761      2487
           2      0.633     0.766     0.693      2487

    accuracy                          0.718      7461
   macro avg      0.731     0.718     0.720      7461
weighted avg      0.731     0.718     0.720      7461

21:41:45 - INFO - 
--- Logistic Regression ---
21:41:45 - INFO -               precision    recall  f1-score   support

           0      0.746     0.751     0.749      2487
           1      0.874     0.821     0.847      2487
           2      0.717     0.756     0.736      2487

    accuracy                          0.776      7461
   macro avg      0.779     0.776     0.777      7461
weighted avg      0.779     0.776     0.777      7461

21:41:45 - INFO - 
===== Multi-Class Classification | TF-IDF + Custom =====
21:41:47 - INFO - k=1: f1=0.6572
21:41:50 - INFO - k=3: f1=0.6734
21:41:52 - INFO - k=5: f1=0.6761
21:41:55 - INFO - k=7: f1=0.6882
21:41:57 - INFO - k=9: f1=0.6875
21:41:59 - INFO - k=11: f1=0.6866
21:42:01 - INFO - k=15: f1=0.6912
21:42:03 - INFO - k=21: f1=0.6933
21:42:03 - INFO - Best k = 21 (score=0.6933)
21:42:05 - INFO - 
--- KNN ---
21:42:05 - INFO -               precision    recall  f1-score   support

           0      0.709     0.697     0.703      2487
           1      0.747     0.694     0.719      2487
           2      0.631     0.686     0.657      2487

    accuracy                          0.692      7461
   macro avg      0.696     0.692     0.693      7461
weighted avg      0.696     0.692     0.693      7461

21:42:11 - INFO - 
--- Logistic Regression ---
21:42:11 - INFO -               precision    recall  f1-score   support

           0      0.759     0.741     0.750      2487
           1      0.885     0.793     0.836      2487
           2      0.701     0.792     0.744      2487

    accuracy                          0.775      7461
   macro avg      0.782     0.775     0.777      7461
weighted avg      0.782     0.775     0.777      7461

21:42:11 - INFO - 
=== STAGE 5: INFERENCE ===
21:42:11 - INFO - --- Training Final Model for Inference (TF-IDF + LR) ---
21:42:11 - INFO - Final model trained successfully.
21:42:11 - INFO - Reading sentences from: knesset_sentences.txt
21:42:11 - INFO - Created output directory: out1
21:42:11 - INFO - Classification results saved to: out1/classification_results.txt
